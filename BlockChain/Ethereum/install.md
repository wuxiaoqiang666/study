# 搭建Ethereum 私有链


## MAC安装Ethereum

### 1、安装以太坊

	brew tap ethereum/ethereum
	brew install ethereum
	
### 2、测试安装结果  

	geth --help

## 私有链搭建
### 1、配置创世区块
> $ cd /usr/local/Cellar/ethereum/1.8.3   
> $ sudo vim piccgenesis.json 配置如下：

	{
	    "config": {
	        "chainID": 1048576,
	        "homesteadBlock": 0,
	        "eip155Block": 0,
	        "eip158Block": 0,
	        "ByzantiumBlock": 0
	    },
	    "alloc": { "0xc1de867b55fdb749be0c927ecf7b19451777042b" : { "balance" : "20000000000000000000"} },
	    "coinbase": "0x0000000000000000000000000000000000000000",
	    "difficulty": "0x0400",
	    "extraData": "0x00",
	    "gasLimit": "0x2fefd8",
	    "nonce": "0xdeadbeefdeadbeef",
	    "mixhash": "0x0000000000000000000000000000000000000000000000000000000000000000",
	    "parentHash": "0x0000000000000000000000000000000000000000000000000000000000000000",
	    "timestamp": "0x00"
	}
### 2、初始化私有链
	mkdir data0
	geth --datadir data0 init piccgenesis.json
### 3、启动私有链

 	geth --identity "ethereum" --rpc --rpcport "8545" --datadir data0 --port "30303" --nodiscover console
 	
上面命令的主体是 `geth console`，表示启动节点并进入交互式控制台。
各选项含义如下：

* identity：指定节点 ID；
* rpc：表示开启 HTTP-RPC 服务；
* rpcport：指定 HTTP-RPC 服务监听端口号（默认为 8545）；
* datadir：指定区块链数据的存储位置；
* port：指定和其他节点连接所用的端口号（默认为 30303）；
* nodiscover：关闭节点发现机制，防止加入有同样初始配置的陌生节点。


## 控制台操作
### 1、创建账户
 
	>
	> personal.newAccount()
	Passphrase:
	Repeat passphrase:
	"0xe302e69bc523ddaa8b2a0e0eb244296f0fca6c38"
	>
### 2、查看账户

	> eth.accounts
	["0xe302e69bc523ddaa8b2a0e0eb244296f0fca6c38"]
	>
### 3、获取账户余额

	> eth.getBalance(eth.accounts[0])  
	0

### 4、挖矿&停止挖矿

#### 启动挖矿：

	> miner.start(1)
其中 start 的参数表示挖矿使用的线程数。第一次启动挖矿会先生成挖矿所需的 DAG 文件，这个过程有点慢，等进度达到 100% 后，就会开始挖矿，此时屏幕会被挖矿信息刷屏。
#### 停止挖矿

	> miner.stop()

挖到一个区块会奖励5个以太币，挖矿所得的奖励会进入矿工的账户，这个账户叫做 coinbase，默认情况下 coinbase 是本地账户中的第一个账户，可以通过 miner.setEtherbase() 将其他账户设置成 coinbase。

###5、发送交易
创建一个新账号，此时，账号1余额为0：

	> eth.getBalance(eth.coinbase)
	1.413e+21
	> eth.getBalance(eth.accounts[1])
	0

先解锁账户0，才能发起交易：

	> personal.unlockAccount(eth.accounts[0])
	Unlock account 0xe302e69bc523ddaa8b2a0e0eb244296f0fca6c38
	Passphrase:
	
	true

发送交易，accounts[0]=>accounts[1]

	> amount=web3.toWei(5,'ether')
	"5000000000000000000"
	>
	eth.sendTransaction({from:eth.accounts[0],to:eth.accounts[1],value:amount})
	INFO [04-13|15:36:54] Submitted transaction                    fullhash=0x2168632ad270384dc425c39b3665f6e6b4b28c20d854ec4fd4bf62449d5b284a recipient=0xB2dc64C78ba27b9c7c06d4417eA5738718DCE001
	"0x2168632ad270384dc425c39b3665f6e6b4b28c20d854ec4fd4bf62449d5b284a"
	
查看交易池，有一个待确认交易：

	> txpool.status
	{
	  pending: 1,
	  queued: 0
	}

查看待确认信息：

	> eth.getBlock("pending",true).transactions
	[{
	    blockHash: "0x921a475fbfcc54ccaa2d78ee8565e2d90160ff28f25e68fd8a824a4d653aa5d7",
	    blockNumber: 472,
	    from: "0xe302e69bc523ddaa8b2a0e0eb244296f0fca6c38",
	    gas: 90000,
	    gasPrice: 18000000000,
	    hash: "0x2168632ad270384dc425c39b3665f6e6b4b28c20d854ec4fd4bf62449d5b284a",
	    input: "0x",
	    nonce: 0,
	    r: "0x8a3fc8213e392f3c1676bca7f495eb0f9f0c6f3fb76142fdc5df95f40ba0ad43",
	    s: "0x6a80625711e7b2a4c99b94691de27431c548ca578739bf2e7569be407d153494",
	    to: "0xb2dc64c78ba27b9c7c06d4417ea5738718dce001",
	    transactionIndex: 0,
	    v: "0x200024",
	    value: 5000000000000000000
	}]
	
开始挖矿：

	> miner.start(1);admin.sleepBlocks(1);miner.stop();
新区块挖出后，挖矿结束，查看账户 1 的余额，已经收到了账户 0 的以太币：

	> web3.fromWei(eth.getBalance(eth.accounts[1]),'ether')
	5

### 6、查看交易和区块

查看当前区块总数：

	> eth.blockNumber
	472

通过交易 Hash 查看交易（Hash 值包含在上面交易返回值中）：

	> eth.getTransaction("0x2168632ad270384dc425c39b3665f6e6b4b28c20d854ec4fd4bf62449d5b284a")
	{
	  blockHash: "0x084ea74429729c824f5ae3538f906a7d69f0ba394ef293e2e33d9153ec916d52",
	  blockNumber: 472,
	  from: "0xe302e69bc523ddaa8b2a0e0eb244296f0fca6c38",
	  gas: 90000,
	  gasPrice: 18000000000,
	  hash: "0x2168632ad270384dc425c39b3665f6e6b4b28c20d854ec4fd4bf62449d5b284a",
	  input: "0x",
	  nonce: 0,
	  r: "0x8a3fc8213e392f3c1676bca7f495eb0f9f0c6f3fb76142fdc5df95f40ba0ad43",
	  s: "0x6a80625711e7b2a4c99b94691de27431c548ca578739bf2e7569be407d153494",
	  to: "0xb2dc64c78ba27b9c7c06d4417ea5738718dce001",
	  transactionIndex: 0,
	  v: "0x200024",
	  value: 5000000000000000000
	}
	
通过区块号查看区块：

	> eth.getBlock(472)
	{
	  difficulty: 153649,
	  extraData: "0xd983010803846765746888676f312e31302e318664617277696e",
	  gasLimit: 4712388,
	  gasUsed: 21000,
	  hash: "0x084ea74429729c824f5ae3538f906a7d69f0ba394ef293e2e33d9153ec916d52",
	  logsBloom: "0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	  miner: "0xe302e69bc523ddaa8b2a0e0eb244296f0fca6c38",
	  mixHash: "0xffd73631b241d9ff2bdd0925cec1a70d9d9c6e2d0bf1e0b52ed37614609f2548",
	  nonce: "0x7edc572c6e42f1c7",
	  number: 472,
	  parentHash: "0xf61cfc65558e3325a4e44e3a23df9813e036d666d2606dac5896dae7f99744ef",
	  receiptsRoot: "0x056b23fbba480696b65fe5a59b8f2148a1299103c4f57df839233af2cf4ca2d2",
	  sha3Uncles: "0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347",
	  size: 656,
	  stateRoot: "0x831c3421e78d0e7a1073d63da0edd19081f258d03c1e80e49dfbaa93f448c65b",
	  timestamp: 1523605534,
	  totalDifficulty: 68690190,
	  transactions: ["0x2168632ad270384dc425c39b3665f6e6b4b28c20d854ec4fd4bf62449d5b284a"],
	  transactionsRoot: "0x827e198fbb2888a781fb5496ee8aaef18a2365680e6efcde7d29ea059d3c5d34",
	  uncles: []
	}
	

## 智能合约
### 1、创建&编译智能合约 
先安装solidity 
	
	brew install solidity

这里以部署erc20为例，[erc20 interface合约标准戳这里](https://theethereum.wiki/w/index.php/ERC20_Token_Standard)

首先创建一个solidity智能合约文件，`token.sol`
	
	pragma solidity ^0.4.0; //指定solidity编译器的最小版本  
	contract MyToken {
           string public name; // token的名称，例如 Tether USD
           string public symbol; // token的代码，例如USDT
           uint8 public decimals; // token的精度,例如4表示该token精确到小数点后4位
  
           mapping (address => uint256) public balances;
  
           event Transfer (address indexed from, address indexed to,uint256 value);
 
          // 合约的初始化函数，在部署合约时被调用，指定供应量等信息
          function MyToken (uint256 initialSupply,string tokenName,string tokenSymbol,uint8 decimal Units){
                  balances[msg.sender] = initialSupply;
                  name = tokenName;
                  symbol = tokenSymbol;
                  decimals = decimalUnits;
          }
 
          function transfer(address _to, uint256 _value) {
                  /* 检查发送方余额充足，且不会溢出 */
                  require(balances[msg.sender]>=_value && balances[_to] + _value >= balances[_to]);
                  balances[msg.sender]-=_value;
                  balances[_to]+=_value;
                  Transfer(msg.sender,_to,_value); // 关注该合约的用户可以得知发生了一笔转账事件
          }

        function balanceOf (address tokenOwner) public constant returns (uint balance) {
                return balances[tokenOwner]; // 查询某个地址的token合约
         }
 	}

编译智能合约，获得编译后的 EVM 二进制码和JSON ABI（Application Binary Interface）：
	
	$ solc token.sol --abi --bin
	======= token.sol:MyToken =======
	Binary:
	6060604052341561000f57600080fd5b6040516107a33803806107a38339810160405280805190602001909190805182019190602001805182019190602001805190602001909190505083600360003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000208190555082600090805190602001906100a39291906100df565b5081600190805190602001906100ba9291906100df565b5080600260006101000a81548160ff021916908360ff16021790555050505050610184565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1061012057805160ff191683800117855561014e565b8280016001018555821561014e579182015b8281111561014d578251825591602001919060010190610132565b5b50905061015b919061015f565b5090565b61018191905b8082111561017d576000816000905550600101610165565b5090565b90565b610610806101936000396000f300606060405260043610610078576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806306fdde031461007d57806327e235e31461010b578063313ce5671461015857806370a082311461018757806395d89b41146101d4578063a9059cbb14610262575b600080fd5b341561008857600080fd5b6100906102a4565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156100d05780820151818401526020810190506100b5565b50505050905090810190601f1680156100fd5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b341561011657600080fd5b610142600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050610342565b6040518082815260200191505060405180910390f35b341561016357600080fd5b61016b61035a565b604051808260ff1660ff16815260200191505060405180910390f35b341561019257600080fd5b6101be600480803573ffffffffffffffffffffffffffffffffffffffff1690602001909190505061036d565b6040518082815260200191505060405180910390f35b34156101df57600080fd5b6101e76103b6565b6040518080602001828103825283818151815260200191508051906020019080838360005b8381101561022757808201518184015260208101905061020c565b50505050905090810190601f1680156102545780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b341561026d57600080fd5b6102a2600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091908035906020019091905050610454565b005b60008054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561033a5780601f1061030f5761010080835404028352916020019161033a565b820191906000526020600020905b81548152906001019060200180831161031d57829003601f168201915b505050505081565b60036020528060005260406000206000915090505481565b600260009054906101000a900460ff1681565b6000600360008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020549050919050565b60018054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561044c5780601f106104215761010080835404028352916020019161044c565b820191906000526020600020905b81548152906001019060200180831161042f57829003601f168201915b505050505081565b80600360003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054101580156105235750600360008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205481600360008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020540110155b151561052e57600080fd5b80600360003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825403925050819055508173ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef836040518082815260200191505060405180910390a350505600a165627a7a72305820065378d830c7093babba9998044f66136a170a72badf049db5f2cc873c98ecd20029
	Contract JSON ABI
	[{"constant":true,"inputs":[],"name":"name","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"balances","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"decimals","outputs":[{"name":"","type":"uint8"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"tokenOwner","type":"address"}],"name":"balanceOf","outputs":[{"name":"balance","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"symbol","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_to","type":"address"},{"name":"_value","type":"uint256"}],"name":"transfer","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"inputs":[{"name":"initialSupply","type":"uint256"},{"name":"tokenName","type":"string"},{"name":"tokenSymbol","type":"string"},{"name":"decimalUnits","type":"uint8"}],"payable":false,"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"name":"from","type":"address"},{"indexed":true,"name":"to","type":"address"},{"indexed":false,"name":"value","type":"uint256"}],"name":"Transfer","type":"event"}]
	
#### 2、部署合约
用变量`code`和`abi`记录上面的编译结果，注意在code前加上‘0x’前缀：
	
	code = "0x6060604052341561000f57600080fd5b6040516107a33803806107a38339810160405280805190602001909190805182019190602001805182019190602001805190602001909190505083600360003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000208190555082600090805190602001906100a39291906100df565b5081600190805190602001906100ba9291906100df565b5080600260006101000a81548160ff021916908360ff16021790555050505050610184565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1061012057805160ff191683800117855561014e565b8280016001018555821561014e579182015b8281111561014d578251825591602001919060010190610132565b5b50905061015b919061015f565b5090565b61018191905b8082111561017d576000816000905550600101610165565b5090565b90565b610610806101936000396000f300606060405260043610610078576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806306fdde031461007d57806327e235e31461010b578063313ce5671461015857806370a082311461018757806395d89b41146101d4578063a9059cbb14610262575b600080fd5b341561008857600080fd5b6100906102a4565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156100d05780820151818401526020810190506100b5565b50505050905090810190601f1680156100fd5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b341561011657600080fd5b610142600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050610342565b6040518082815260200191505060405180910390f35b341561016357600080fd5b61016b61035a565b604051808260ff1660ff16815260200191505060405180910390f35b341561019257600080fd5b6101be600480803573ffffffffffffffffffffffffffffffffffffffff1690602001909190505061036d565b6040518082815260200191505060405180910390f35b34156101df57600080fd5b6101e76103b6565b6040518080602001828103825283818151815260200191508051906020019080838360005b8381101561022757808201518184015260208101905061020c565b50505050905090810190601f1680156102545780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b341561026d57600080fd5b6102a2600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091908035906020019091905050610454565b005b60008054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561033a5780601f1061030f5761010080835404028352916020019161033a565b820191906000526020600020905b81548152906001019060200180831161031d57829003601f168201915b505050505081565b60036020528060005260406000206000915090505481565b600260009054906101000a900460ff1681565b6000600360008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020549050919050565b60018054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561044c5780601f106104215761010080835404028352916020019161044c565b820191906000526020600020905b81548152906001019060200180831161042f57829003601f168201915b505050505081565b80600360003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054101580156105235750600360008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205481600360008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020540110155b151561052e57600080fd5b80600360003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825403925050819055508173ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef836040518082815260200191505060405180910390a350505600a165627a7a72305820065378d830c7093babba9998044f66136a170a72badf049db5f2cc873c98ecd20029"
	abi = [{"constant":true,"inputs":[],"name":"name","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"balances","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"decimals","outputs":[{"name":"","type":"uint8"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"tokenOwner","type":"address"}],"name":"balanceOf","outputs":[{"name":"balance","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"symbol","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_to","type":"address"},{"name":"_value","type":"uint256"}],"name":"transfer","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"inputs":[{"name":"initialSupply","type":"uint256"},{"name":"tokenName","type":"string"},{"name":"tokenSymbol","type":"string"},{"name":"decimalUnits","type":"uint8"}],"payable":false,"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"name":"from","type":"address"},{"indexed":true,"name":"to","type":"address"},{"indexed":false,"name":"value","type":"uint256"}],"name":"Transfer","type":"event"}]
	
这里使用账户 coinbase（即0） 来部署合约，首先解锁账户：

	> personal.unlockAccount(eth.coinbase)
	Unlock account 0xe302e69bc523ddaa8b2a0e0eb244296f0fca6c38
	Passphrase:
	
创建合约交易：初始化参数、合约部署方、gas limit；因为没有接收方，也不需要发送以太币，所以省略to和value
	
	> myContract = eth.contract(abi).new(100000,'TEST token',"TEST",2,{from:eth.coinbase,data:code,gas:1000000})
	> myContract.transactionHash
	"0xcfe1aecb0e6b61de134a0ee6dd0a4c947d0282fff88e6e34aa1ec11ca4c1ae1c"

挖矿&查看结果：
	
	>  miner.start(); admin.sleepBlocks(1); miner.stop();
	> eth.getTransaction(myContract.transactionHash)
	{
	  blockHash: "0x3286f2b69f915d6cdb9f6587280e13701d044a57f05fcffa0c98e30ab1cf23b2",
	  blockNumber: 474,
	  from: "0xe302e69bc523ddaa8b2a0e0eb244296f0fca6c38",
	  gas: 1000000,
	  gasPrice: 18000000000,
	  hash: "0xcfe1aecb0e6b61de134a0ee6dd0a4c947d0282fff88e6e34aa1ec11ca4c1ae1c",
	  input: "0x6060604052341561000f57600080fd5b6040516107a33803806107a38339810160405280805190602001909190805182019190602001805182019190602001805190602001909190505083600360003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000208190555082600090805190602001906100a39291906100df565b5081600190805190602001906100ba9291906100df565b5080600260006101000a81548160ff021916908360ff16021790555050505050610184565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1061012057805160ff191683800117855561014e565b8280016001018555821561014e579182015b8281111561014d578251825591602001919060010190610132565b5b50905061015b919061015f565b5090565b61018191905b8082111561017d576000816000905550600101610165565b5090565b90565b610610806101936000396000f300606060405260043610610078576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806306fdde031461007d57806327e235e31461010b578063313ce5671461015857806370a082311461018757806395d89b41146101d4578063a9059cbb14610262575b600080fd5b341561008857600080fd5b6100906102a4565b6040518080602001828103825283818151815260200191508051906020019080838360005b838110156100d05780820151818401526020810190506100b5565b50505050905090810190601f1680156100fd5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b341561011657600080fd5b610142600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050610342565b6040518082815260200191505060405180910390f35b341561016357600080fd5b61016b61035a565b604051808260ff1660ff16815260200191505060405180910390f35b341561019257600080fd5b6101be600480803573ffffffffffffffffffffffffffffffffffffffff1690602001909190505061036d565b6040518082815260200191505060405180910390f35b34156101df57600080fd5b6101e76103b6565b6040518080602001828103825283818151815260200191508051906020019080838360005b8381101561022757808201518184015260208101905061020c565b50505050905090810190601f1680156102545780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b341561026d57600080fd5b6102a2600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091908035906020019091905050610454565b005b60008054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561033a5780601f1061030f5761010080835404028352916020019161033a565b820191906000526020600020905b81548152906001019060200180831161031d57829003601f168201915b505050505081565b60036020528060005260406000206000915090505481565b600260009054906101000a900460ff1681565b6000600360008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020549050919050565b60018054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561044c5780601f106104215761010080835404028352916020019161044c565b820191906000526020600020905b81548152906001019060200180831161042f57829003601f168201915b505050505081565b80600360003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054101580156105235750600360008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205481600360008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020540110155b151561052e57600080fd5b80600360003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825403925050819055508173ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef836040518082815260200191505060405180910390a350505600a165627a7a72305820065378d830c7093babba9998044f66136a170a72badf049db5f2cc873c98ecd2002900000000000000000000000000000000000000000000000000000000000186a0000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000a5445535420746f6b656e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000045445535400000000000000000000000000000000000000000000000000000000",
	  nonce: 3,
	  r: "0xe730dc69e33be956b1b36e4be39098c5c5843510140e4491742c2c01e26253f9",
	  s: "0x32936c56ab61c873e8504e5ae08583c96fdc3e5c1b0021c0bb49eb763d88b1c8",
	  to: null,
	  transactionIndex: 0,
	  v: "0x200023",
	  value: 0
	}
	> eth.getTransactionReceipt(myContract.transactionHash)
	{
	  blockHash: "0x3286f2b69f915d6cdb9f6587280e13701d044a57f05fcffa0c98e30ab1cf23b2",
	  blockNumber: 474,
	  contractAddress: "0x849a732d523ecb29c6950d2a44b2ad388e0a8286", // 合约地址
	  cumulativeGasUsed: 574493,
	  from: "0xe302e69bc523ddaa8b2a0e0eb244296f0fca6c38", // coinbase地址
	  gasUsed: 574493, // 消耗gas数量
	  logs: [],
	  logsBloom: "0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
	  status: "0x1",
	  to: null,
	  transactionHash: "0xcfe1aecb0e6b61de134a0ee6dd0a4c947d0282fff88e6e34aa1ec11ca4c1ae1c",
	  transactionIndex: 0
	}
	> myContract.address
	"0x70047f71bd83fbaeb343c44bb386cbd83511532d"

合约部署到了`0x70047f71bd83fbaeb343c44bb386cbd83511532d `这个地址，消耗了574493gas。如此就“发行”了一个ERC20 Token，名字是 TEST token，代码 TEST ，一共发行 10000 个，每个 token 精确到小数点后 2 位。

####3、调用智能合约
上述myContract即为合约对象，但每次调用都创建合约过于麻烦，我们使用上述合约地址创建合约对象：
	
	> myContract=eth.contract(abi).at("0x70047f71bd83fbaeb343c44bb386cbd83511532d")
	
转账，解锁用户coinbase，往accounts[1]转账100

	> personal.unlockAccount(eth.coinbase)
	Unlock account 0xc1de867b55fdb749be0c927ecf7b19451777042b
	Passphrase: 
	true
	> txHash=myContract.transfer.sendTransaction(eth.accounts[1],100,{from:eth.coinbase,gas:100000})
	
挖矿&查看交易信息

	> miner.start(); admin.sleepBlocks(1); miner.stop();
	> myContract.balanceOf(eth.accounts[1])
	100
	> myContract.balanceOf(eth.accounts[0])
	999900
	> eth.getTransaction(txHash)
	{
	  blockHash: "0xe274014cf4ec89977844fd1e4b065bc7e783b89de9f4ba74de2e087b882a1480",
	  blockNumber: 487,
	  from: "0xe302e69bc523ddaa8b2a0e0eb244296f0fca6c38",
	  gas: 100000,
	  gasPrice: 18000000000,
	  hash: "0xeb018db9f757fcdb28094c271ec9f81aea2bd82abd5ce5d8f44dd7886c01b6ef",
	  input: "0xa9059cbb000000000000000000000000b2dc64c78ba27b9c7c06d4417ea5738718dce0010000000000000000000000000000000000000000000000000000000000000064",
	  nonce: 10,
	  r: "0xbc0709ef2d76773c14d67d9c4894a8162dfe8f46581a973773d3c245c40ae10d",
	  s: "0x12c8be585f7ce7effdd420144c6574e3762749aa0b35964bac376cb74b1db466",
	  to: "0x70047f71bd83fbaeb343c44bb386cbd83511532d",
	  transactionIndex: 0,
	  v: "0x200023",
	  value: 0
	}
	> eth.getTransactionReceipt(txHash)
	{
	  blockHash: "0xe274014cf4ec89977844fd1e4b065bc7e783b89de9f4ba74de2e087b882a1480",
	  blockNumber: 487,
	  contractAddress: null,
	  cumulativeGasUsed: 51595,
	  from: "0xe302e69bc523ddaa8b2a0e0eb244296f0fca6c38",
	  gasUsed: 51595,
	  logs: [{
	      address: "0x70047f71bd83fbaeb343c44bb386cbd83511532d",
	      blockHash: "0xe274014cf4ec89977844fd1e4b065bc7e783b89de9f4ba74de2e087b882a1480",
	      blockNumber: 487,
	      data: "0x0000000000000000000000000000000000000000000000000000000000000064",
	      logIndex: 0,
	      removed: false,
	      topics: ["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef", "0x000000000000000000000000e302e69bc523ddaa8b2a0e0eb244296f0fca6c38", "0x000000000000000000000000b2dc64c78ba27b9c7c06d4417ea5738718dce001"],
	      transactionHash: "0xeb018db9f757fcdb28094c271ec9f81aea2bd82abd5ce5d8f44dd7886c01b6ef",
	      transactionIndex: 0
	  }],
	  logsBloom: "0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000080000000000000000000000000000000000000000000000000000000000000010000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000008000400001000000000000002000000000000000000000000000080000000000000000010000000000000000000000000000000000000000000000000000000000010000000000000",
	  status: "0x1",
	  to: "0x70047f71bd83fbaeb343c44bb386cbd83511532d",
	  transactionHash: "0xeb018db9f757fcdb28094c271ec9f81aea2bd82abd5ce5d8f44dd7886c01b6ef",
	  transactionIndex: 0
	}
	

